import{a as f}from"./chunk-UQBFF3T4.js";import{Cb as u,F as s,Hb as m,I as r,Qb as p,X as a,ac as h,nb as c,qb as l}from"./chunk-RYV5VKQF.js";var d=(()=>{class i{constructor(e,t,o){this.http=e,this.platformId=t,this.appService=o}isLoggedIn(){if(c(this.platformId)){let e=localStorage.getItem("token");if(e){let t=this.getTokenExpirationDate(e);return t===void 0||t<=new Date?(this.logout(),!1):(this.setUserClient(),!0)}}return!1}getTokenExpirationDate(e){try{let t=JSON.parse(atob(e.split(".")[1]));return t&&t.exp?new Date(t.exp*1e3):void 0}catch{return}}logout(){localStorage.removeItem("token")}setUserClient(){this.appService.getAndSetUserDefaultClient()}static{this.\u0275fac=function(t){return new(t||i)(r(l),r(a),r(p))}}static{this.\u0275prov=s({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var A=(()=>{class i{constructor(e,t,o,n){this.authService=e,this.userService=t,this.router=o,this.modal=n}canActivate(e,t){if(this.authService.isLoggedIn()){if(this.userService.loggedInUser.is_admin)return!0;let o=e.data.permission;return o&&!this.userService.hasPermission(o)?(o==f.MainDashboard?this.router.navigate(["/employee"]):this.modal.create({nzTitle:"Insufficient Permission!",nzContent:"You do not have permission to view this content. Please contact with admin for queries.",nzFooter:null}).afterClose.subscribe(()=>{localStorage.removeItem("redirectUrl"),this.router.navigate([this.router.lastSuccessfulNavigation?.previousNavigation])}),!1):!0}else return this.router.navigate(["/login"]),!1}static{this.\u0275fac=function(t){return new(t||i)(r(d),r(m),r(u),r(h))}}static{this.\u0275prov=s({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();export{A as a};
