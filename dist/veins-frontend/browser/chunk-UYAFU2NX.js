import{b as Ne}from"./chunk-GNP2NW3U.js";import{$ as n,$a as U,$b as se,Ac as Se,Bb as re,Bc as Ie,Ca as A,Cb as ae,Cc as be,Da as j,Dc as Ee,Eb as me,Fb as le,Ga as $,Gb as pe,Ha as W,Ic as Te,K as l,L as M,Q as u,R as c,Wa as G,Ya as V,_ as t,_b as ce,aa as d,ac as de,ba as T,bc as _e,ca as N,cc as ue,da as F,db as Q,dc as fe,ea as f,eb as Z,fa as s,fb as H,gb as J,ja as D,ka as m,la as P,ma as _,na as q,nb as X,oa as R,ob as Y,pa as L,qa as K,qb as ee,r as O,ra as w,rb as I,s as b,sa as S,sb as te,tb as ne,tc as ge,ua as x,uc as ze,v as y,vc as ye,w as v,wa as h,wc as ve,xa as B,xb as ie,xc as xe,yb as oe,yc as he,z as E,zc as Ce}from"./chunk-HDWWHYKZ.js";import"./chunk-NFQMHT45.js";import{g as C}from"./chunk-MON7YFGF.js";function Ve(i,o){i&1&&(t(0,"nz-form-item")(1,"nz-form-label",16),m(2,"PO Number"),n(),t(3,"nz-form-control"),d(4,"input",24),n()())}function ke(i,o){i&1&&(t(0,"nz-form-item")(1,"nz-form-label",16),m(2,"Sale Id"),n(),t(3,"nz-form-control"),d(4,"input",25),n()())}function Oe(i,o){if(i&1){let e=F();T(0),t(1,"form",15),f("ngSubmit",function(){y(e);let a=s();return v(a.submitForm())}),t(2,"nz-form-item")(3,"nz-form-label",16),m(4,"Stock In"),n(),t(5,"nz-form-control"),d(6,"nz-switch",17),n()(),u(7,Ve,5,0,"nz-form-item",18)(8,ke,5,0,"nz-form-item",18),t(9,"nz-form-item")(10,"nz-form-label",16),m(11,"Item name"),n(),t(12,"nz-form-control"),d(13,"input",19),n()(),t(14,"nz-form-item")(15,"nz-form-label",16),m(16,"Vendor"),n(),t(17,"nz-form-control"),d(18,"input",20),n()(),t(19,"nz-form-item")(20,"nz-form-label",16),m(21,"Quantity"),n(),t(22,"nz-form-control")(23,"input",21),f("ngModelChange",function(){y(e);let a=s();return v(a.setTotal())}),n()()(),t(24,"nz-form-item")(25,"nz-form-label",16),m(26,"Unit Price"),n(),t(27,"nz-form-control")(28,"input",22),f("ngModelChange",function(){y(e);let a=s();return v(a.setTotal())}),n()()(),t(29,"nz-form-item")(30,"nz-form-label",16),m(31,"Total"),n(),t(32,"nz-form-control")(33,"h4"),m(34),x(35,"currency"),n()()(),t(36,"nz-form-item")(37,"nz-form-label",16),m(38,"Description"),n(),t(39,"nz-form-control"),d(40,"textarea",23),n()()(),N()}if(i&2){let e=s(),r,a,p;l(),c("formGroup",e.inventoryItemForm),l(6),c("ngIf",(r=e.inventoryItemForm.get("stock_in"))==null?null:r.value),l(),c("ngIf",!((a=e.inventoryItemForm.get("stock_in"))!=null&&a.value)),l(26),P(h(35,4,(p=e.inventoryItemForm.get("total"))==null?null:p.value,"PKR "))}}var De=()=>["/","purchase","purchase"],k=i=>({PO:i});function Pe(i,o){if(i&1&&(t(0,"a",31),m(1),n()),i&2){let e=s().$implicit;c("routerLink",w(3,De))("queryParams",S(4,k,e.purchase_no)),l(),_("PO -",e.purchase_no,"")}}var qe=()=>["/","sales","sale"];function Re(i,o){if(i&1&&(t(0,"a",31),m(1),n()),i&2){let e=s().$implicit;c("routerLink",w(3,qe))("queryParams",S(4,k,e.sale_no)),l(),_("SALE -",e.sale_no||e.sale_id,"")}}var Le=i=>["/","sites",i];function Ke(i,o){if(i&1&&(t(0,"a",31),m(1),n()),i&2){let e=s().$implicit;c("routerLink",S(3,Le,e.site_id))("queryParams",S(5,k,e.sale_no)),l(),_("SITE -",e.site_no||e.site_id,"")}}function Be(i,o){if(i&1&&(T(0),t(1,"tr",29)(2,"td"),u(3,Pe,2,6,"a",30)(4,Re,2,6,"a",30)(5,Ke,2,7,"a",30),n(),t(6,"td"),m(7),n(),t(8,"td"),m(9),x(10,"currency"),n(),t(11,"td"),m(12),x(13,"currency"),n()(),N()),i&2){let e=o.$implicit;l(),c("className",e.stock_in?"purchase-row":"sale-row"),l(2),c("ngIf",e.stock_in),l(),c("ngIf",!e.stock_in&&e.sale_no),l(),c("ngIf",!e.stock_in&&(e.site_no||e.site_id)),l(2),q(" ",e.stock_in?"+":"-"," ",e.qty," "),l(2),_(" ",h(10,8,e.unit_price,"PKR ")," "),l(3),_(" ",h(13,11,e.total,"PKR ")," ")}}function Ae(i,o){if(i&1){let e=F();t(0,"span",34),f("click",function(){y(e);let a=s(2),p=a.$implicit,g=a.index,z=s();return v(z.onExpandChange(p.item_name,!0,g))}),n()}}function je(i,o){if(i&1){let e=F();t(0,"span",35),f("click",function(){y(e);let a=s(2),p=a.$implicit,g=a.index,z=s();return v(z.onExpandChange(p.item_name,!1,g))}),n()}}function $e(i,o){if(i&1&&u(0,Ae,1,0,"span",32)(1,je,1,0,"span",33),i&2){let e=s().$implicit,r=s();c("ngIf",!r.expandSet.has(e.item_name)),l(),c("ngIf",r.expandSet.has(e.item_name))}}function We(i,o){if(i&1&&(T(0),t(1,"tr"),d(2,"td",26),t(3,"td"),m(4),n(),t(5,"td"),m(6),n(),t(7,"td"),m(8),n(),t(9,"td"),m(10),x(11,"currency"),n(),t(12,"td"),m(13),x(14,"currency"),n()(),t(15,"tr",27)(16,"nz-table",7)(17,"thead")(18,"tr")(19,"th",11),m(20,"Reference #"),n(),t(21,"th",11),m(22,"Quantity"),n(),t(23,"th",12),m(24,"Unit Price"),n(),t(25,"th",13),m(26,"Total"),n()()(),t(27,"tbody"),u(28,Be,14,14,"ng-container",14),n()()(),u(29,$e,2,2,"ng-template",null,28,B),N()),i&2){let e=o.$implicit,r=D(30),a=s();l(2),c("nzExpand",a.expandSet.has(e.item_name))("nzExpandIcon",r),l(2),_(" ",e.item_name," "),l(2),_(" ",e.vendor_name," "),l(2),_(" ",e.qty," "),l(2),_(" ",h(11,13,e.latest_unit_price,"PKR ")," "),l(3),_(" ",h(14,16,e.qty*e.latest_unit_price,"PKR ")," "),l(2),c("nzExpand",a.expandSet.has(e.item_name)),l(),c("nzShowPagination",!1)("nzData",e.subDetails)("nzFrontPagination",!1)("nzLoading",a.loading),l(12),c("ngForOf",e.subDetails)}}var Me=(()=>{let o=class o{constructor(r,a){this.fb=r,this.appService=a,this.inventory=[],this.loading=!1,this.vendorItems=[],this.isVisible=!1,this.expandSet=new Set,this.currentOrganizationId=0,this.inventoryItemForm=this.fb.group({purchase_id:[null],sale_id:[null],stock_in:[!0,I.required],name:[null,I.required],vendor_id:[0],qty:[null,I.required],unit_price:[null,I.required],description:[null],total:[null]})}onExpandChange(r,a,p){return C(this,null,function*(){a?(this.inventory[p].expanded||(this.inventory[p].subDetails=yield this.appService.getInventoryItemDetails(r),this.inventory[p].expanded=!0),this.expandSet.add(r)):this.expandSet.delete(r)})}handleCancel(){console.log("Button cancel clicked!"),this.isVisible=!1,this.inventoryItemForm.reset()}ngOnInit(){this.subOrgSubscription=this.appService.currentSubOrganization.subscribe(r=>{r&&r.id>0&&this.currentOrganizationId!=r.id&&(this.currentOrganizationId=r.id,this.loadInventory())})}ngOnDestroy(){this.subOrgSubscription&&this.subOrgSubscription.unsubscribe()}loadInventory(){return C(this,null,function*(){this.loading=!0,this.inventory=yield this.appService.getInventory(),this.loading=!1})}onVendorChange(){return C(this,null,function*(){this.vendorItems=yield this.appService.getVendorItems(this.selectedVendor?.id)})}addOrUpdateItem(){}deleteItem(r){}editItem(r){}addItem(){}clearForm(){}submitForm(){return C(this,null,function*(){if(this.inventoryItemForm.valid){let r=yield this.appService.addInventory(this.inventoryItemForm.getRawValue());console.log(r),this.isVisible=!1,this.inventoryItemForm.reset(),this.loadInventory()}})}setTotal(){this.inventoryItemForm.get("total")?.setValue(this.inventoryItemForm.get("qty")?.value*this.inventoryItemForm.get("unit_price")?.value)}};o.\u0275fac=function(a){return new(a||o)(M(ae),M(U))},o.\u0275cmp=O({type:o,selectors:[["app-inventory-management"]],decls:24,vars:10,consts:[[1,"container"],[1,"section"],[1,"flex","space-between",2,"margin","12px"],["nz-button","","nzType","primary",3,"nzSize","click"],["nz-icon","","nzType","plus"],["nzTitle","Add inventory item",3,"nzVisible","nzOkText","nzOkDisabled","nzVisibleChange","nzOnCancel","nzOnOk"],[4,"nzModalContent"],[3,"nzShowPagination","nzData","nzFrontPagination","nzLoading"],["nzWidth","60px"],["nzColumnKey","item_name",3,"nzSortFn"],["nzColumnKey","vendor_name"],["nzColumnKey","qty"],["nzColumnKey","latest_unit_price"],["nzColumnKey","total"],[4,"ngFor","ngForOf"],["nz-form","",3,"formGroup","ngSubmit"],["nzRequired",""],["formControlName","stock_in"],[4,"ngIf"],["nz-input","","formControlName","name"],["nz-input","","formControlName","vendor_id"],["nz-input","","formControlName","qty",3,"ngModelChange"],["nz-input","","formControlName","unit_price",3,"ngModelChange"],["nz-input","","formControlName","description"],["nz-input","","formControlName","purchase_id"],["nz-input","","formControlName","sale_id"],[3,"nzExpand","nzExpandIcon"],[3,"nzExpand"],["expandIcon",""],[3,"className"],["href","",3,"routerLink","queryParams",4,"ngIf"],["href","",3,"routerLink","queryParams"],["nz-icon","","nzType","caret-right","nzTheme","outline",3,"click",4,"ngIf"],["nz-icon","","nzType","caret-down","nzTheme","outline",3,"click",4,"ngIf"],["nz-icon","","nzType","caret-right","nzTheme","outline",3,"click"],["nz-icon","","nzType","caret-down","nzTheme","outline",3,"click"]],template:function(a,p){a&1&&(t(0,"div",0)(1,"div",1)(2,"div",2),d(3,"span"),t(4,"button",3),f("click",function(){return p.isVisible=!p.isVisible}),d(5,"span",4),n()(),t(6,"nz-modal",5),K("nzVisibleChange",function(z){return L(p.isVisible,z)||(p.isVisible=z),z}),f("nzOnCancel",function(){return p.handleCancel()})("nzOnOk",function(){return p.submitForm()}),u(7,Oe,41,7,"ng-container",6),n(),t(8,"nz-table",7)(9,"thead")(10,"tr"),d(11,"th",8),t(12,"th",9),m(13,"Name"),n(),t(14,"th",10),m(15,"Vendor"),n(),t(16,"th",11),m(17,"Quantity"),n(),t(18,"th",12),m(19,"Unit Price"),n(),t(20,"th",13),m(21,"Total"),n()()(),t(22,"tbody"),u(23,We,31,19,"ng-container",14),n()()()()),a&2&&(l(4),c("nzSize","small"),l(2),R("nzVisible",p.isVisible),c("nzOkText","Submit")("nzOkDisabled",!p.inventoryItemForm.valid),l(2),c("nzShowPagination",!1)("nzData",p.inventory)("nzFrontPagination",!1)("nzLoading",p.loading),l(4),c("nzSortFn",!0),l(11),c("ngForOf",p.inventory))},dependencies:[G,A,j,J,Z,H,Q,se,ce,_e,de,fe,ue,pe,Y,X,ge,Se,ve,ze,xe,ye,be,Ce,Ie,Ee,he,ie,ee,te,ne,oe,re,$]});let i=o;return i})();var Ge=[{path:"",component:Me,data:{name:" "}}],we=(()=>{let o=class o{};o.\u0275fac=function(a){return new(a||o)},o.\u0275mod=b({type:o}),o.\u0275inj=E({imports:[V.forChild(Ge),V]});let i=o;return i})();var xt=(()=>{let o=class o{};o.\u0275fac=function(a){return new(a||o)},o.\u0275mod=b({type:o}),o.\u0275inj=E({imports:[we,W,Te,le,Ne,me]});let i=o;return i})();export{xt as InventoryManagementModule};
