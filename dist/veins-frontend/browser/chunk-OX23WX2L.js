import{b as Te}from"./chunk-72DL5HJQ.js";import{$ as t,$a as G,Ac as Ce,Bb as oe,Bc as Se,Ca as B,Cb as re,Cc as Ie,Da as A,Db as ae,Dc as be,Ga as j,Ha as W,Ic as Ee,K as l,L as F,Q as u,R as c,Vb as me,Wa as $,Wb as le,Xb as pe,Ya as V,Yb as ce,Zb as se,_ as e,_b as de,aa as d,ba as E,ca as T,da as N,db as U,ea as f,fa as s,fb as Q,gb as S,hb as Z,ib as H,ja as O,ka as m,la as D,ma as _,mb as J,na as P,nb as X,oa as q,pa as R,pc as _e,qa as L,qb as Y,qc as ue,r as k,ra as w,rb as ee,s as I,sa as M,tb as te,tc as fe,ua as x,ub as ne,uc as ze,v as y,vb as ie,vc as ge,w as v,wa as h,wc as ye,xa as K,xc as ve,yc as xe,z as b,zc as he}from"./chunk-3TINHIPJ.js";import"./chunk-NFQMHT45.js";import{g as C}from"./chunk-MON7YFGF.js";function Ve(i,o){i&1&&(e(0,"nz-form-item")(1,"nz-form-label",16),m(2,"PO Number"),t(),e(3,"nz-form-control"),d(4,"input",24),t()())}function ke(i,o){i&1&&(e(0,"nz-form-item")(1,"nz-form-label",16),m(2,"Sale Id"),t(),e(3,"nz-form-control"),d(4,"input",25),t()())}function Oe(i,o){if(i&1){let n=N();E(0),e(1,"form",15),f("ngSubmit",function(){y(n);let a=s();return v(a.submitForm())}),e(2,"nz-form-item")(3,"nz-form-label",16),m(4,"Stock In"),t(),e(5,"nz-form-control"),d(6,"nz-switch",17),t()(),u(7,Ve,5,0,"nz-form-item",18)(8,ke,5,0,"nz-form-item",18),e(9,"nz-form-item")(10,"nz-form-label",16),m(11,"Item name"),t(),e(12,"nz-form-control"),d(13,"input",19),t()(),e(14,"nz-form-item")(15,"nz-form-label",16),m(16,"Vendor"),t(),e(17,"nz-form-control"),d(18,"input",20),t()(),e(19,"nz-form-item")(20,"nz-form-label",16),m(21,"Quantity"),t(),e(22,"nz-form-control")(23,"input",21),f("ngModelChange",function(){y(n);let a=s();return v(a.setTotal())}),t()()(),e(24,"nz-form-item")(25,"nz-form-label",16),m(26,"Unit Price"),t(),e(27,"nz-form-control")(28,"input",22),f("ngModelChange",function(){y(n);let a=s();return v(a.setTotal())}),t()()(),e(29,"nz-form-item")(30,"nz-form-label",16),m(31,"Total"),t(),e(32,"nz-form-control")(33,"h4"),m(34),x(35,"currency"),t()()(),e(36,"nz-form-item")(37,"nz-form-label",16),m(38,"Description"),t(),e(39,"nz-form-control"),d(40,"textarea",23),t()()(),T()}if(i&2){let n=s(),r,a,p;l(),c("formGroup",n.inventoryItemForm),l(6),c("ngIf",(r=n.inventoryItemForm.get("stock_in"))==null?null:r.value),l(),c("ngIf",!((a=n.inventoryItemForm.get("stock_in"))!=null&&a.value)),l(26),D(h(35,4,(p=n.inventoryItemForm.get("total"))==null?null:p.value,"PKR "))}}var De=()=>["/","purchase","purchase"],Fe=i=>({PO:i});function Pe(i,o){if(i&1&&(e(0,"a",31),m(1),t()),i&2){let n=s().$implicit;c("routerLink",w(3,De))("queryParams",M(4,Fe,n.purchase_no)),l(),_("PO -",n.purchase_no,"")}}var qe=()=>["/","sales","sale"];function Re(i,o){if(i&1&&(e(0,"a",31),m(1),t()),i&2){let n=s().$implicit;c("routerLink",w(3,qe))("queryParams",M(4,Fe,n.sale_no)),l(),_("SALE -",n.sale_no||n.sale_id,"")}}function Le(i,o){if(i&1&&(E(0),e(1,"tr",29)(2,"td"),u(3,Pe,2,6,"a",30)(4,Re,2,6,"a",30),t(),e(5,"td"),m(6),t(),e(7,"td"),m(8),x(9,"currency"),t(),e(10,"td"),m(11),x(12,"currency"),t()(),T()),i&2){let n=o.$implicit;l(),c("className",n.stock_in?"purchase-row":"sale-row"),l(2),c("ngIf",n.stock_in),l(),c("ngIf",!n.stock_in),l(2),P(" ",n.stock_in?"+":"-"," ",n.qty," "),l(2),_(" ",h(9,7,n.unit_price,"PKR ")," "),l(3),_(" ",h(12,10,n.total,"PKR ")," ")}}function Ke(i,o){if(i&1){let n=N();e(0,"span",34),f("click",function(){y(n);let a=s(2),p=a.$implicit,z=a.index,g=s();return v(g.onExpandChange(p.item_name,!0,z))}),t()}}function Be(i,o){if(i&1){let n=N();e(0,"span",35),f("click",function(){y(n);let a=s(2),p=a.$implicit,z=a.index,g=s();return v(g.onExpandChange(p.item_name,!1,z))}),t()}}function Ae(i,o){if(i&1&&u(0,Ke,1,0,"span",32)(1,Be,1,0,"span",33),i&2){let n=s().$implicit,r=s();c("ngIf",!r.expandSet.has(n.item_name)),l(),c("ngIf",r.expandSet.has(n.item_name))}}function je(i,o){if(i&1&&(E(0),e(1,"tr"),d(2,"td",26),e(3,"td"),m(4),t(),e(5,"td"),m(6),t(),e(7,"td"),m(8),t(),e(9,"td"),m(10),x(11,"currency"),t(),e(12,"td"),m(13),x(14,"currency"),t()(),e(15,"tr",27)(16,"nz-table",7)(17,"thead")(18,"tr")(19,"th",11),m(20,"Reference #"),t(),e(21,"th",11),m(22,"Quantity"),t(),e(23,"th",12),m(24,"Unit Price"),t(),e(25,"th",13),m(26,"Total"),t()()(),e(27,"tbody"),u(28,Le,13,13,"ng-container",14),t()()(),u(29,Ae,2,2,"ng-template",null,28,K),T()),i&2){let n=o.$implicit,r=O(30),a=s();l(2),c("nzExpand",a.expandSet.has(n.item_name))("nzExpandIcon",r),l(2),_(" ",n.item_name," "),l(2),_(" ",n.vendor_name," "),l(2),_(" ",n.qty," "),l(2),_(" ",h(11,13,n.latest_unit_price,"PKR ")," "),l(3),_(" ",h(14,16,n.qty*n.latest_unit_price,"PKR ")," "),l(2),c("nzExpand",a.expandSet.has(n.item_name)),l(),c("nzShowPagination",!1)("nzData",n.subDetails)("nzFrontPagination",!1)("nzLoading",a.loading),l(12),c("ngForOf",n.subDetails)}}var we=(()=>{let o=class o{constructor(r,a){this.fb=r,this.appService=a,this.inventory=[],this.loading=!1,this.vendorItems=[],this.isVisible=!1,this.expandSet=new Set,this.currentOrganizationId=0,this.inventoryItemForm=this.fb.group({purchase_id:[null],sale_id:[null],stock_in:[!0,S.required],name:[null,S.required],vendor_id:[0],qty:[null,S.required],unit_price:[null,S.required],description:[null],total:[null]})}onExpandChange(r,a,p){return C(this,null,function*(){a?(this.inventory[p].expanded||(this.inventory[p].subDetails=yield this.appService.getInventoryItemDetails(r),this.inventory[p].expanded=!0),this.expandSet.add(r)):this.expandSet.delete(r)})}handleCancel(){console.log("Button cancel clicked!"),this.isVisible=!1,this.inventoryItemForm.reset()}ngOnInit(){this.subOrgSubscription=this.appService.currentSubOrganization.subscribe(r=>{r&&r.id>0&&this.currentOrganizationId!=r.id&&(this.currentOrganizationId=r.id,this.loadInventory())})}ngOnDestroy(){this.subOrgSubscription&&this.subOrgSubscription.unsubscribe()}loadInventory(){return C(this,null,function*(){this.loading=!0,this.inventory=yield this.appService.getInventory(),this.loading=!1})}onVendorChange(){return C(this,null,function*(){this.vendorItems=yield this.appService.getVendorItems(this.selectedVendor?.id)})}addOrUpdateItem(){}deleteItem(r){}editItem(r){}addItem(){}clearForm(){}submitForm(){return C(this,null,function*(){if(this.inventoryItemForm.valid){let r=yield this.appService.addInventory(this.inventoryItemForm.getRawValue());console.log(r),this.isVisible=!1,this.inventoryItemForm.reset(),this.loadInventory()}})}setTotal(){this.inventoryItemForm.get("total")?.setValue(this.inventoryItemForm.get("qty")?.value*this.inventoryItemForm.get("unit_price")?.value)}};o.\u0275fac=function(a){return new(a||o)(F(ee),F(G))},o.\u0275cmp=k({type:o,selectors:[["app-inventory-management"]],decls:24,vars:10,consts:[[1,"container"],[1,"section"],[1,"flex","space-between",2,"margin","12px"],["nz-button","","nzType","primary",3,"nzSize","click"],["nz-icon","","nzType","plus"],["nzTitle","Add inventory item",3,"nzVisible","nzOkText","nzOkDisabled","nzVisibleChange","nzOnCancel","nzOnOk"],[4,"nzModalContent"],[3,"nzShowPagination","nzData","nzFrontPagination","nzLoading"],["nzWidth","60px"],["nzColumnKey","item_name",3,"nzSortFn"],["nzColumnKey","vendor_name"],["nzColumnKey","qty"],["nzColumnKey","latest_unit_price"],["nzColumnKey","total"],[4,"ngFor","ngForOf"],["nz-form","",3,"formGroup","ngSubmit"],["nzRequired",""],["formControlName","stock_in"],[4,"ngIf"],["nz-input","","formControlName","name"],["nz-input","","formControlName","vendor_id"],["nz-input","","formControlName","qty",3,"ngModelChange"],["nz-input","","formControlName","unit_price",3,"ngModelChange"],["nz-input","","formControlName","description"],["nz-input","","formControlName","purchase_id"],["nz-input","","formControlName","sale_id"],[3,"nzExpand","nzExpandIcon"],[3,"nzExpand"],["expandIcon",""],[3,"className"],["href","",3,"routerLink","queryParams",4,"ngIf"],["href","",3,"routerLink","queryParams"],["nz-icon","","nzType","caret-right","nzTheme","outline",3,"click",4,"ngIf"],["nz-icon","","nzType","caret-down","nzTheme","outline",3,"click",4,"ngIf"],["nz-icon","","nzType","caret-right","nzTheme","outline",3,"click"],["nz-icon","","nzType","caret-down","nzTheme","outline",3,"click"]],template:function(a,p){a&1&&(e(0,"div",0)(1,"div",1)(2,"div",2),d(3,"span"),e(4,"button",3),f("click",function(){return p.isVisible=!p.isVisible}),d(5,"span",4),t()(),e(6,"nz-modal",5),L("nzVisibleChange",function(g){return R(p.isVisible,g)||(p.isVisible=g),g}),f("nzOnCancel",function(){return p.handleCancel()})("nzOnOk",function(){return p.submitForm()}),u(7,Oe,41,7,"ng-container",6),t(),e(8,"nz-table",7)(9,"thead")(10,"tr"),d(11,"th",8),e(12,"th",9),m(13,"Name"),t(),e(14,"th",10),m(15,"Vendor"),t(),e(16,"th",11),m(17,"Quantity"),t(),e(18,"th",12),m(19,"Unit Price"),t(),e(20,"th",13),m(21,"Total"),t()()(),e(22,"tbody"),u(23,je,31,19,"ng-container",14),t()()()()),a&2&&(l(4),c("nzSize","small"),l(2),q("nzVisible",p.isVisible),c("nzOkText","Submit")("nzOkDisabled",!p.inventoryItemForm.valid),l(2),c("nzShowPagination",!1)("nzData",p.inventory)("nzFrontPagination",!1)("nzLoading",p.loading),l(4),c("nzSortFn",!0),l(11),c("ngForOf",p.inventory))},dependencies:[$,B,A,ae,oe,re,U,le,me,ce,pe,de,se,ie,ue,_e,fe,Ce,ye,ze,ve,ge,Ie,he,Se,be,xe,J,Q,Z,H,X,Y,j]});let i=o;return i})();var We=[{path:"",component:we,data:{name:" "}}],Me=(()=>{let o=class o{};o.\u0275fac=function(a){return new(a||o)},o.\u0275mod=I({type:o}),o.\u0275inj=b({imports:[V.forChild(We),V]});let i=o;return i})();var yt=(()=>{let o=class o{};o.\u0275fac=function(a){return new(a||o)},o.\u0275mod=I({type:o}),o.\u0275inj=b({imports:[Me,W,Ee,ne,Te,te]});let i=o;return i})();export{yt as InventoryManagementModule};
