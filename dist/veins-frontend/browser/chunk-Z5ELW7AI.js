import{$ as l,$a as T,Ac as W,Bb as F,Bc as j,Ca as S,Cb as P,Da as oe,Db as k,Gc as Te,Ha as re,Hb as he,Hc as Oe,Ib as Ce,J as G,K as d,L as v,Q as h,R as m,Tb as ze,Ub as ge,Vb as ve,Wb as xe,Xb as Ve,Ya as H,Za as ae,Zb as we,_ as a,_b as ye,a as ee,aa as x,ba as $,bb as le,ca as q,cb as se,da as g,db as de,ea as f,fa as s,fb as O,gb as Y,hb as E,ib as me,ja as Z,ka as p,la as ie,lb as I,ma as J,nb as pe,oa as V,oc as De,pa as w,pc as be,q as te,qa as y,qb as ce,r as D,rb as fe,rc as Ne,s as b,tb as _e,tc as A,ub as ue,v as _,vb as M,vc as Se,w as u,wc as U,xa as ne,yc as B,z as N,zc as L}from"./chunk-TWOT2RKP.js";import"./chunk-NFQMHT45.js";import{a as R,g as z}from"./chunk-MON7YFGF.js";function Re(i,r){if(i&1&&(a(0,"tr")(1,"td"),p(2),l()()),i&2){let o=r.$implicit;d(2),ie(o.name)}}function Ge(i,r){if(i&1){let o=g();a(0,"div",2)(1,"input",3),y("ngModelChange",function(t){_(o);let n=s();return w(n.newProduct,t)||(n.newProduct=t),u(t)}),l(),a(2,"button",4),f("click",function(){_(o);let t=s();return u(t.handleAddProduct())}),p(3,"Add Product"),l(),a(4,"nz-table",5)(5,"thead")(6,"tr")(7,"th",6),p(8,"Product Name"),l()()(),a(9,"tbody"),h(10,Re,3,1,"tr",7),l()()()}if(i&2){let o=s();d(),V("ngModel",o.newProduct),d(3),m("nzData",o.products),d(6),m("ngForOf",o.products)}}var Ee=(()=>{let r=class r{constructor(e){this.appService=e,this.visible=!1,this.closeDrawer=new te,this.placement="right",this.products=[],this.newProduct=""}ngOnInit(){this.getAndSetItems()}getAndSetItems(){return z(this,null,function*(){this.products=yield this.appService.getVendorItems(this.vendor.id)})}addNewItem(){return z(this,null,function*(){this.newProduct&&this.newProduct.trim()&&(yield this.appService.addVendorItem(this.vendor.id,this.newProduct.trim()))})}showDrawer(){this.visible=!0}onClose(){this.visible=!1,this.closeDrawer.emit(!0)}handleAddProduct(){return z(this,null,function*(){this.newProduct.trim()!==""&&(this.products.push({name:this.newProduct.trim()}),yield this.addNewItem(),this.newProduct="",this.getAndSetItems())})}};r.\u0275fac=function(t){return new(t||r)(v(T))},r.\u0275cmp=D({type:r,selectors:[["app-vendor-details"]],inputs:{vendor:"vendor",visible:"visible"},outputs:{closeDrawer:"closeDrawer"},decls:2,vars:4,consts:[[3,"nzClosable","nzVisible","nzPlacement","nzTitle","nzOnClose"],["class","vendor-details",4,"nzDrawerContent"],[1,"vendor-details"],["nz-input","","placeholder","Enter product name",2,"margin-bottom","12px",3,"ngModel","ngModelChange"],["nz-button","","nzType","primary",2,"margin-bottom","12px",3,"click"],["nzShowPagination","false","nzBordered","",3,"nzData"],["nzWidth","50%"],[4,"ngFor","ngForOf"]],template:function(t,n){t&1&&(a(0,"nz-drawer",0),f("nzOnClose",function(){return n.onClose()}),h(1,Ge,11,3,"div",1),l()),t&2&&m("nzClosable",!1)("nzVisible",n.visible)("nzPlacement",n.placement)("nzTitle",n.vendor.name)},dependencies:[S,k,F,P,ge,ze,M,L,A,U,j,B,W,O,E,I]});let i=r;return i})();function qe(i,r){if(i&1){let o=g();a(0,"app-vendor-details",8),f("closeDrawer",function(){_(o);let t=s();return u(t.drawerVisible=!1)}),l()}if(i&2){let o=s();m("vendor",o.selectedVendor)("visible",o.drawerVisible)}}function Ze(i,r){if(i&1&&($(0),x(1,"span",16),a(2,"div",17),p(3,"Upload"),l(),q()),i&2){let o=s(2);d(),m("nzType",o.loading?"loading":"plus")}}function Je(i,r){if(i&1&&x(0,"img",18),i&2){let o=s(2);m("src",o.avatarUrl,G)}}function He(i,r){if(i&1){let o=g();a(0,"nz-form",9)(1,"nz-form-item")(2,"nz-form-label",10),p(3,"Vendor Name"),l(),a(4,"nz-form-control",11),x(5,"input",12),l()(),a(6,"nz-form-item")(7,"nz-form-label",10),p(8,"Vendor Name"),l(),a(9,"nz-form-control",11)(10,"nz-upload",13),f("nzChange",function(t){_(o);let n=s();return u(n.handleChange(t))}),h(11,Ze,4,1,"ng-container",14)(12,Je,1,1,"img",15),l()()()()}if(i&2){let o=s();m("formGroup",o.addVendorForm),d(10),m("nzShowUploadList",!1)("nzBeforeUpload",o.beforeUpload),d(),m("ngIf",!o.avatarUrl),d(),m("ngIf",o.avatarUrl)}}function Ye(i,r){if(i&1&&(a(0,"th",19),p(1),l()),i&2){let o=r.$implicit;m("nzSortFn",o.compare)("nzSortPriority",o.priority),d(),J(" ",o.title," ")}}function Ke(i,r){if(i&1){let o=g();$(0),a(1,"td")(2,"div")(3,"span",22),f("click",function(){_(o);let t=s().$implicit,n=s();return u(n.viewDetails(t))}),l(),x(4,"img",23),a(5,"span"),p(6),l()()(),a(7,"td")(8,"a",24),f("click",function(){_(o);let t=s().$implicit,n=s();return u(n.startEdit(t.id))}),p(9,"Edit"),l()(),q()}if(i&2){let o=s().$implicit,e=s();d(4),m("src",e.apiUrl+"/images/"+o.filename,G),d(2),J(" ",o.name,"")}}function Qe(i,r){if(i&1){let o=g();a(0,"td")(1,"input",25),y("ngModelChange",function(t){_(o);let n=s().$implicit,c=s();return w(c.editCache[n.id].data.name,t)||(c.editCache[n.id].data.name=t),u(t)}),l()(),a(2,"td")(3,"a",26),f("click",function(){_(o);let t=s().$implicit,n=s();return u(n.saveEdit(t.id))}),p(4,"Save"),l(),p(5," \xA0 "),a(6,"a",27),f("nzOnConfirm",function(){_(o);let t=s().$implicit,n=s();return u(n.cancelEdit(t.id))}),p(7,"Cancel"),l()()}if(i&2){let o=s().$implicit,e=s();d(),V("ngModel",e.editCache[o.id].data.name)}}function Xe(i,r){if(i&1&&(a(0,"tr"),h(1,Ke,10,2,"ng-container",20)(2,Qe,8,1,"ng-template",null,21,ne),l()),i&2){let o=r.$implicit,e=Z(3),t=s();d(),m("ngIf",!(t.editCache[o.id]!=null&&t.editCache[o.id].edit))("ngIfElse",e)}}var Ie=(()=>{let r=class r{constructor(e,t){this.appService=e,this.fb=t,this.apiUrl=ae.apiUrl,this.isModalVisible=!1,this.drawerVisible=!1,this.selectedVendor={},this.listOfColumn=[{title:"Name",compare:(n,c)=>n.name.localeCompare(c.name),priority:!1},{title:"Action",compare:(n,c)=>n.role_id-c.role_id,priority:!1}],this.listOfData=[],this.visible=!1,this.editCache={},this.beforeUpload=(n,c)=>new ee(C=>{let Q=n.type==="image/jpeg"||n.type==="image/png";if(!Q){this.msg.error("You can only upload JPG file!"),C.complete();return}let X=n.size/1024/1024<2;if(!X){this.msg.error("Image must smaller than 2MB!"),C.complete();return}this.addVendorForm.patchValue({file:n}),C.next(Q&&X),C.complete()}),this.addVendorForm=this.fb.group({name:["",[Y.required]],file:["",[Y.required]]})}showModal(){this.isModalVisible=!0}handleOk(){return z(this,null,function*(){yield this.appService.createVendor(this.addVendorForm.value.name,this.addVendorForm.value.file),this.isModalVisible=!1,this.populateVendorData()})}handleCancel(){this.isModalVisible=!1}ngOnInit(){this.populateVendorData()}open(){this.visible=!0}close(e=!1){this.visible=!1,e&&this.populateVendorData()}populateVendorData(){return z(this,null,function*(){this.listOfData=yield this.appService.getVendors(),this.updateEditCache()})}startEdit(e){this.editCache[e].edit=!0}cancelEdit(e){let t=this.listOfData.findIndex(n=>n.id===e);this.editCache[e]={data:R({},this.listOfData[t]),edit:!1}}saveEdit(e){return z(this,null,function*(){let t=this.listOfData.findIndex(n=>n.id===e);yield this.appService.updateVendor({id:e,organization_id:this.editCache[e].data.organization_id,role_id:this.editCache[e].data.role_id,reports_to:this.editCache[e].data.reports_to,name:this.editCache[e].data.name}),this.editCache[e].edit=!1,Object.assign(this.listOfData[t],this.editCache[e].data),this.populateVendorData()})}updateEditCache(){this.listOfData.forEach(e=>{this.editCache[e.id]={edit:!1,data:R({},e)}})}viewDetails(e){this.selectedVendor=e,this.drawerVisible=!0}getBase64(e,t){let n=new FileReader;n.addEventListener("load",()=>t(n.result.toString())),n.readAsDataURL(e)}handleChange(e){this.getBase64(e.file.originFileObj,t=>{this.loading=!1,this.avatarUrl=t})}};r.\u0275fac=function(t){return new(t||r)(v(T),v(fe))},r.\u0275cmp=D({type:r,selectors:[["app-vendor"]],decls:14,vars:5,consts:[["nz-button","","nzType","primary",3,"click"],[3,"vendor","visible","closeDrawer",4,"ngIf"],["nzTitle","Add Vendor",3,"nzVisible","nzVisibleChange","nzOnCancel","nzOnOk"],[3,"formGroup",4,"nzModalContent"],["nzTableLayout","fixed",3,"nzData"],["editRowTable","","sortTable",""],[3,"nzSortFn","nzSortPriority",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[3,"vendor","visible","closeDrawer"],[3,"formGroup"],["nzRequired",""],["nzHasFeedback","","nzErrorTip","Please input Vendor name"],["nz-input","","formControlName","name"],["nzAction","null","nzName","avatar","nzListType","picture-card",1,"avatar-uploader",3,"nzShowUploadList","nzBeforeUpload","nzChange"],[4,"ngIf"],["style","width: 100%",3,"src",4,"ngIf"],["nz-icon","",1,"upload-icon",3,"nzType"],[1,"ant-upload-text"],[2,"width","100%",3,"src"],[3,"nzSortFn","nzSortPriority"],[4,"ngIf","ngIfElse"],["editTemplate",""],["nz-button","","nz-icon","","nzType","profile","nzTheme","outline",3,"click"],["alt","",1,"smallIcon",3,"src"],[3,"click"],["type","text","nz-input","",3,"ngModel","ngModelChange"],[1,"save",3,"click"],["nz-popconfirm","","nzPopconfirmTitle","Sure to cancel?",3,"nzOnConfirm"]],template:function(t,n){if(t&1&&(a(0,"div")(1,"button",0),f("click",function(){return n.showModal()}),p(2,"Add Vendor"),l()(),h(3,qe,1,2,"app-vendor-details",1),a(4,"nz-modal",2),y("nzVisibleChange",function(C){return w(n.isModalVisible,C)||(n.isModalVisible=C),C}),f("nzOnCancel",function(){return n.handleCancel()})("nzOnOk",function(){return n.handleOk()}),h(5,He,13,5,"nz-form",3),l(),a(6,"nz-table",4,5)(9,"thead")(10,"tr"),h(11,Ye,2,3,"th",6),l()(),a(12,"tbody"),h(13,Xe,4,2,"tr",7),l()()),t&2){let c=Z(8);d(3),m("ngIf",n.drawerVisible),d(),V("nzVisible",n.isModalVisible),d(2),m("nzData",n.listOfData),d(5),m("ngForOf",n.listOfColumn),d(2),m("ngForOf",c.data)}},dependencies:[S,oe,k,F,P,de,xe,ve,Ve,ye,we,M,be,De,Ne,L,Se,A,U,j,B,W,Te,O,E,me,pe,ce,I,Ee],styles:["[_nghost-%COMP%]     .avatar-uploader>.ant-upload{width:128px;height:128px}"]});let i=r;return i})();var et=[{path:"",component:Ie,children:[],data:{name:""}}],Me=(()=>{let r=class r{};r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=b({type:r}),r.\u0275inj=N({imports:[H.forChild(et),H]});let i=r;return i})();var Fe=le,tt=Object.keys(Fe).map(i=>Fe[i]),Pt=(()=>{let r=class r{};r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=b({type:r}),r.\u0275inj=N({providers:[{provide:Ce,useValue:he},{provide:se,useValue:tt}],imports:[re,Me,Oe,ue,_e]});let i=r;return i})();export{Pt as VendorModule};
