import{a as l}from"./chunk-KHERLNJF.js";import{D as s,G as c,I as r,Qa as u,Ta as f,cb as m,hb as p,jb as h,vb as d}from"./chunk-WFCTZNAN.js";var v=(()=>{let e=class e{constructor(i,t,n){this.http=i,this.platformId=t,this.appService=n}isLoggedIn(){if(u(this.platformId)){let i=localStorage.getItem("token");if(i){let t=this.getTokenExpirationDate(i);return t===void 0||t<=new Date?(this.logout(),!1):(this.setUserSubOrganization(),!0)}}return!1}getTokenExpirationDate(i){try{let t=JSON.parse(atob(i.split(".")[1]));return t&&t.exp?new Date(t.exp*1e3):void 0}catch{return}}logout(){localStorage.removeItem("token")}setUserSubOrganization(){this.appService.getAndSetUserDefaultSubOrganization()}};e.\u0275fac=function(t){return new(t||e)(r(f),r(c),r(h))},e.\u0275prov=s({token:e,factory:e.\u0275fac,providedIn:"root"});let o=e;return o})();var O=(()=>{let e=class e{constructor(i,t,n,a){this.authService=i,this.userService=t,this.router=n,this.modal=a}canActivate(i,t){if(this.authService.isLoggedIn()){if(this.userService.loggedInUser.is_admin)return!0;let n=i.data.permission;return n&&!this.userService.hasPermission(n)?(n==l.MainDashboardView?this.router.navigate(["/employee"]):this.modal.create({nzTitle:"Insufficient Permission!",nzContent:"You do not have permission to view this content. Please contact with admin for queries.",nzFooter:null}).afterClose.subscribe(()=>{this.router.navigate([this.router.lastSuccessfulNavigation?.previousNavigation])}),!1):!0}else return this.router.navigate(["/login"]),!1}};e.\u0275fac=function(t){return new(t||e)(r(v),r(p),r(m),r(d))},e.\u0275prov=s({token:e,factory:e.\u0275fac,providedIn:"root"});let o=e;return o})();export{O as a};
