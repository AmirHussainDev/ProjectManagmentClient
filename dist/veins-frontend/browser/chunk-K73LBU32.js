import{a as $}from"./chunk-NGE6N3H6.js";import{$ as u,Aa as b,Ab as J,B as N,Bb as L,Ec as Y,Fb as H,Gb as Z,Ha as f,J as p,K as a,Ka as I,Ma as S,Na as y,Nb as q,Q as l,Tb as W,Ua as F,Ub as U,Vb as K,Wa as _,Wb as Q,Xb as X,Z as n,_ as s,_a as x,ab as P,bb as w,da as C,db as D,eb as d,fb as M,gb as O,ja as c,kb as j,lb as k,ob as E,qb as T,r as v,rb as A,s as h,sb as R,tb as V,ub as G,z,zb as B}from"./chunk-R4PMELZD.js";import{g}from"./chunk-MON7YFGF.js";var tt=(()=>{let t=class t{constructor(i,o,m,r,it){this.fb=i,this.http=o,this.platformId=m,this.router=r,this.appService=it,this.organization_id=0,this.validateForm=this.fb.group({username:["",[d.required]],password:["",[d.required]],remember:[!0]}),f(this.platformId)&&(this.organization_id=parseInt(localStorage.getItem("organization_id")||""))}submitForm(){return g(this,null,function*(){if(this.validateForm.valid){console.log("submit",this.validateForm.value);let i=20,o=this.validateForm.value.password||"",m=this.validateForm.value.username||"";this.http.post("/api/auth/login",{organization_id:this.organization_id,username:m,password:o}).toPromise().then(r=>{f(this.platformId)&&r.access_token&&(localStorage.setItem("token",r.access_token),localStorage.setItem("user",JSON.stringify(r.user)),localStorage.setItem("permissions",JSON.stringify(r.user.role_permissions)),localStorage.setItem("sub_organization_id",JSON.stringify(r.user.sub_organization_id)),this.router.navigate(["/"]))})}else Object.values(this.validateForm.controls).forEach(i=>{i.invalid&&(i.markAsDirty(),i.updateValueAndValidity({onlySelf:!0}))})})}};t.\u0275fac=function(o){return new(o||t)(a(T),a(I),a(N),a(F),a(x))},t.\u0275cmp=v({type:t,selectors:[["app-login"]],decls:19,vars:3,consts:[[1,"app-login"],[1,"text-center","p4"],["nz-form","",1,"login-form",3,"formGroup","ngSubmit"],["nzErrorTip","Please input your username!"],["nzPrefixIcon","user"],["type","text","nz-input","","formControlName","username","placeholder","username"],["nzErrorTip","Please input your Password!"],["nzPrefixIcon","lock"],["type","password","nz-input","","formControlName","password","placeholder","Password"],["nz-row","",1,"login-form-margin"],["nz-col","",3,"nzSpan"],["nz-checkbox","","formControlName","remember"],["nz-button","",1,"login-form-button","login-form-margin",3,"nzType"]],template:function(o,m){o&1&&(n(0,"div",0)(1,"h2",1),c(2," Welcome Back!"),s(),n(3,"form",2),C("ngSubmit",function(){return m.submitForm()}),n(4,"nz-form-item")(5,"nz-form-control",3)(6,"nz-input-group",4),u(7,"input",5),s()()(),n(8,"nz-form-item")(9,"nz-form-control",6)(10,"nz-input-group",7),u(11,"input",8),s()()(),n(12,"div",9)(13,"div",10)(14,"label",11)(15,"span"),c(16,"Remember me"),s()()()(),n(17,"button",12),c(18,"Log in"),s()()()),o&2&&(p(3),l("formGroup",m.validateForm),p(10),l("nzSpan",12),p(4),l("nzType","primary"))},dependencies:[j,D,M,O,k,E,L,B,J,q,U,W,Q,K,X,V,G],styles:[".login-form[_ngcontent-%COMP%]{max-width:300px}.login-form-margin[_ngcontent-%COMP%]{margin-bottom:16px}.login-form-forgot[_ngcontent-%COMP%]{float:right}.login-form-button[_ngcontent-%COMP%]{width:100%}.app-login[_ngcontent-%COMP%]{background:#fff;padding:32px;margin:50px;border-radius:12px}"]});let e=t;return e})();var ot=[{path:"",component:tt}];b($);var et=P,nt=Object.keys(et).map(e=>et[e]),At=(()=>{let t=class t{};t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=h({type:t}),t.\u0275inj=z({providers:[_(ot),{provide:Z,useValue:H},{provide:w,useValue:nt}],imports:[A,S,y,R,Y]});let e=t;return e})();export{At as a};
