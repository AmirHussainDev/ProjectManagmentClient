import{a as Me}from"./chunk-MXELYLGR.js";import{$ as R,A as h,Aa as x,Ab as X,B as y,Ca as v,Cb as E,Da as F,Db as Y,E as T,Eb as ee,Hb as te,Hc as ze,Ib as ne,Ic as he,Ja as A,Jb as ie,Jc as ye,Ka as W,Kc as xe,Lc as ve,Mb as oe,Mc as Ce,Nb as re,Nc as Se,Oa as j,Oc as Ie,P as m,Pa as G,Pb as ae,Pc as Ee,Q as V,Qb as le,Qc as be,Rb as me,Rc as Te,Sb as pe,Tb as ce,V as g,Vc as we,W as c,da as n,db as U,e as C,ea as i,fa as u,fb as L,ga as w,ha as M,ia as S,ja as z,jb as $,ka as s,kc as se,lc as de,nb as Q,nc as _e,oa as N,ob as Z,oc as ue,pa as l,pc as fe,qa as K,qc as ge,ra as _,sa as B,ta as D,ua as O,va as k,w as q,wb as H,x as b,xa as P,xb as J,ya as I}from"./chunk-FK7IKGFG.js";function Oe(e,o){if(e&1){let t=S();n(0,"span",20),z("click",function(){h(t);let a=s(2);return a.searchValue="",y(a.search())}),i()}}function ke(e,o){e&1&&u(0,"span",21)}function Pe(e,o){if(e&1&&g(0,Oe,1,0,"span",19)(1,ke,1,0),e&2){let t=s();R(0,t.searchValue?0:1)}}function Le(e,o){e&1&&u(0,"span",21)}function qe(e,o){e&1&&(n(0,"nz-form-item")(1,"nz-form-label",23),l(2,"PO Number"),i(),n(3,"nz-form-control"),u(4,"input",31),i()())}function Re(e,o){e&1&&(n(0,"nz-form-item")(1,"nz-form-label",23),l(2,"Sale Id"),i(),n(3,"nz-form-control"),u(4,"input",32),i()())}function Ke(e,o){if(e&1){let t=S();w(0),n(1,"form",22),z("ngSubmit",function(){h(t);let a=s();return y(a.submitForm())}),n(2,"nz-form-item")(3,"nz-form-label",23),l(4,"Stock In"),i(),n(5,"nz-form-control"),u(6,"nz-switch",24),i()(),g(7,qe,5,0,"nz-form-item",25)(8,Re,5,0,"nz-form-item",25),n(9,"nz-form-item")(10,"nz-form-label",23),l(11,"Item name"),i(),n(12,"nz-form-control"),u(13,"input",26),i()(),n(14,"nz-form-item")(15,"nz-form-label",23),l(16,"Vendor"),i(),n(17,"nz-form-control"),u(18,"input",27),i()(),n(19,"nz-form-item")(20,"nz-form-label",23),l(21,"Quantity"),i(),n(22,"nz-form-control")(23,"input",28),z("ngModelChange",function(){h(t);let a=s();return y(a.setTotal())}),i()()(),n(24,"nz-form-item")(25,"nz-form-label",23),l(26,"Unit Price"),i(),n(27,"nz-form-control")(28,"input",29),z("ngModelChange",function(){h(t);let a=s();return y(a.setTotal())}),i()()(),n(29,"nz-form-item")(30,"nz-form-label",23),l(31,"Total"),i(),n(32,"nz-form-control")(33,"h4"),l(34),x(35,"currency"),i()()(),n(36,"nz-form-item")(37,"nz-form-label",23),l(38,"Description"),i(),n(39,"nz-form-control"),u(40,"textarea",30),i()()(),M()}if(e&2){let t=s(),r,a,p;m(),c("formGroup",t.inventoryItemForm),m(6),c("ngIf",(r=t.inventoryItemForm.get("stock_in"))==null?null:r.value),m(),c("ngIf",!((a=t.inventoryItemForm.get("stock_in"))!=null&&a.value)),m(26),K(v(35,4,(p=t.inventoryItemForm.get("total"))==null?null:p.value,"PKR "))}}var Be=()=>["/","purchase","purchase"],Fe=e=>({PO:e});function Ae(e,o){if(e&1&&(n(0,"a",39),l(1),i()),e&2){let t=s().$implicit;c("routerLink",P(3,Be))("queryParams",I(4,Fe,t.purchase_no)),m(),_("PO -",t.purchase_no,"")}}var We=()=>["/","purchase","sales","sale"],je=e=>({SALE:e});function Ge(e,o){if(e&1&&(n(0,"a",39),l(1),i()),e&2){let t=s().$implicit;c("routerLink",P(3,We))("queryParams",I(4,je,t.sale_no)),m(),_("SALE -",t.sale_no||t.sale_id,"")}}var Ue=e=>["/","sites",e];function $e(e,o){if(e&1&&(n(0,"a",39),l(1),i()),e&2){let t=s().$implicit;c("routerLink",I(3,Ue,t.site_id))("queryParams",I(5,Fe,t.sale_no)),m(),_("SITE -",t.site_no||t.site_id,"")}}function Qe(e,o){if(e&1&&(w(0),n(1,"tr",37)(2,"td"),g(3,Ae,2,6,"a",38)(4,Ge,2,6,"a",38)(5,$e,2,7,"a",38),i(),n(6,"td"),l(7),i(),n(8,"td"),l(9),x(10,"currency"),i(),n(11,"td"),l(12),x(13,"currency"),i()(),M()),e&2){let t=o.$implicit;m(),c("className",t.stock_in?"purchase-row":"sale-row"),m(2),c("ngIf",t.stock_in),m(),c("ngIf",!t.stock_in&&t.sale_no),m(),c("ngIf",!t.stock_in&&(t.site_no||t.site_id)),m(2),B(" ",t.stock_in?"+":"-"," ",t.qty," "),m(2),_(" ",v(10,8,t.unit_price,"PKR ")," "),m(3),_(" ",v(13,11,t.total,"PKR ")," ")}}function Ze(e,o){if(e&1){let t=S();n(0,"span",42),z("click",function(){h(t);let a=s(2),p=a.$implicit,f=a.index,d=s();return y(d.onExpandChange(p.item_name,!0,f))}),i()}}function He(e,o){if(e&1){let t=S();n(0,"span",43),z("click",function(){h(t);let a=s(2),p=a.$implicit,f=a.index,d=s();return y(d.onExpandChange(p.item_name,!1,f))}),i()}}function Je(e,o){if(e&1&&g(0,Ze,1,0,"span",40)(1,He,1,0,"span",41),e&2){let t=s().$implicit,r=s();c("ngIf",!r.expandSet.has(t.item_name)),m(),c("ngIf",r.expandSet.has(t.item_name))}}function Xe(e,o){if(e&1&&(w(0),n(1,"tr"),u(2,"td",33),n(3,"td"),l(4),i(),n(5,"td"),l(6),i(),n(7,"td"),l(8),i(),n(9,"td"),l(10),x(11,"currency"),i(),n(12,"td"),l(13),x(14,"currency"),i(),n(15,"td"),l(16),x(17,"currency"),i()(),n(18,"tr",34)(19,"nz-table",35)(20,"thead")(21,"tr")(22,"th",15),l(23,"Reference #"),i(),n(24,"th",15),l(25,"Quantity"),i(),n(26,"th",16),l(27,"Unit Price"),i(),n(28,"th",17),l(29,"Total"),i()()(),n(30,"tbody"),g(31,Qe,14,14,"ng-container",18),i()()(),g(32,Je,2,2,"ng-template",null,36,F),M()),e&2){let t=o.$implicit,r=N(33),a=s();m(2),c("nzExpand",a.expandSet.has(t.item_name))("nzExpandIcon",r),m(2),_(" ",t.item_name," "),m(2),_(" ",t.vendor_name," "),m(2),_(" ",t.qty," "),m(2),_(" ",v(11,15,t.latest_unit_price,"PKR ")," "),m(3),_(" ",v(14,18,t.avg_unit_price,"PKR ")," "),m(3),_(" ",v(17,21,t.qty*t.latest_unit_price,"PKR ")," "),m(2),c("nzExpand",a.expandSet.has(t.item_name)),m(),c("nzPageSize",1e3)("nzShowPagination",!1)("nzData",t.subDetails)("nzFrontPagination",!1)("nzLoading",a.loading),m(12),c("ngForOf",t.subDetails)}}var Ve=(()=>{let o=class o{constructor(r,a){this.fb=r,this.appService=a,this.inventory=[],this.loading=!1,this.vendorItems=[],this.isVisible=!1,this.expandSet=new Set,this.currentOrganizationId=0,this.inventoryItemForm=this.fb.group({purchase_id:[null],sale_id:[null],stock_in:[!0,E.required],name:[null,E.required],vendor_id:[0],qty:[null,E.required],unit_price:[null,E.required],description:[null],total:[null]})}onExpandChange(r,a,p){return C(this,null,function*(){a?(this.inventory[p].expanded||(this.inventory[p].subDetails=yield this.appService.getInventoryItemDetails(r),this.inventory[p].expanded=!0),this.expandSet.add(r)):this.expandSet.delete(r)})}handleCancel(){console.log("Button cancel clicked!"),this.isVisible=!1,this.inventoryItemForm.reset()}ngOnInit(){this.subOrgSubscription=this.appService.currentSubOrganization.subscribe(r=>{r&&r.id>0&&this.currentOrganizationId!=r.id&&(this.currentOrganizationId=r.id,this.loadInventory())})}ngOnDestroy(){this.subOrgSubscription&&this.subOrgSubscription.unsubscribe()}loadInventory(){return C(this,null,function*(){this.loading=!0,this.inventory=yield this.appService.getInventory(),this.listOfDisplayData=this.inventory,this.loading=!1})}onVendorChange(){return C(this,null,function*(){this.vendorItems=yield this.appService.getVendorItems(this.selectedVendor?.id)})}addOrUpdateItem(){}deleteItem(r){}editItem(r){}addItem(){}clearForm(){}submitForm(){return C(this,null,function*(){if(this.inventoryItemForm.valid){let r=yield this.appService.addInventory(this.inventoryItemForm.getRawValue());console.log(r),this.isVisible=!1,this.inventoryItemForm.reset(),this.loadInventory()}})}setTotal(){this.inventoryItemForm.get("total")?.setValue(this.inventoryItemForm.get("qty")?.value*this.inventoryItemForm.get("unit_price")?.value)}search(){this.searchVisible=!1,this.searchValue?(this.listOfDisplayData=this.inventory.filter(r=>r.vendor_name&&r.vendor_name.toLowerCase().indexOf(this.searchValue.toLowerCase())>-1||r.item_name&&r.item_name.toLowerCase().indexOf(this.searchValue.toLowerCase())>-1),console.log(this.listOfDisplayData)):this.listOfDisplayData=this.inventory}};o.\u0275fac=function(a){return new(a||o)(V(re),V($))},o.\u0275cmp=q({type:o,selectors:[["app-inventory-management"]],decls:32,vars:13,consts:[[1,"container"],[1,"section"],[1,"flex","space-between",2,"margin","12px"],[2,"display","-webkit-box","width","100%"],[2,"margin-right","5px"],[3,"nzSuffix"],["type","text","placeholder","Search here","nz-input","",3,"ngModel","ngModelChange","keyup"],["inputClearTpl",""],["suffixIconSearch",""],["nzTitle","Add inventory item",3,"nzVisible","nzOkText","nzOkDisabled","nzVisibleChange","nzOnCancel","nzOnOk"],[4,"nzModalContent"],[3,"nzShowPagination","nzPageSize","nzData","nzFrontPagination","nzLoading"],["nzWidth","60px"],["nzColumnKey","item_name",3,"nzSortFn"],["nzColumnKey","vendor_name"],["nzColumnKey","qty"],["nzColumnKey","latest_unit_price"],["nzColumnKey","total"],[4,"ngFor","ngForOf"],["nz-icon","","class","ant-input-clear-icon","nzTheme","fill","nzType","close-circle"],["nz-icon","","nzTheme","fill","nzType","close-circle",1,"ant-input-clear-icon",3,"click"],["nz-icon","","nzType","search"],["nz-form","",3,"formGroup","ngSubmit"],["nzRequired",""],["formControlName","stock_in"],[4,"ngIf"],["nz-input","","formControlName","name"],["nz-input","","formControlName","vendor_id"],["nz-input","","formControlName","qty",3,"ngModelChange"],["nz-input","","formControlName","unit_price",3,"ngModelChange"],["nz-input","","formControlName","description"],["nz-input","","formControlName","purchase_id"],["nz-input","","formControlName","sale_id"],[3,"nzExpand","nzExpandIcon"],[3,"nzExpand"],[3,"nzPageSize","nzShowPagination","nzData","nzFrontPagination","nzLoading"],["expandIcon",""],[3,"className"],["href","",3,"routerLink","queryParams",4,"ngIf"],["href","",3,"routerLink","queryParams"],["nz-icon","","nzType","caret-right","nzTheme","outline",3,"click",4,"ngIf"],["nz-icon","","nzType","caret-down","nzTheme","outline",3,"click",4,"ngIf"],["nz-icon","","nzType","caret-right","nzTheme","outline",3,"click"],["nz-icon","","nzType","caret-down","nzTheme","outline",3,"click"]],template:function(a,p){if(a&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"span",3)(4,"h3",4),l(5," Inventory "),i(),n(6,"nz-input-group",5)(7,"input",6),k("ngModelChange",function(d){return O(p.searchValue,d)||(p.searchValue=d),d}),z("keyup",function(){return p.search()}),i()(),g(8,Pe,2,1,"ng-template",null,7,F)(10,Le,1,0,"ng-template",null,8,F),i()(),n(12,"nz-modal",9),k("nzVisibleChange",function(d){return O(p.isVisible,d)||(p.isVisible=d),d}),z("nzOnCancel",function(){return p.handleCancel()})("nzOnOk",function(){return p.submitForm()}),g(13,Ke,41,7,"ng-container",10),i(),n(14,"nz-table",11)(15,"thead")(16,"tr"),u(17,"th",12),n(18,"th",13),l(19,"Name"),i(),n(20,"th",14),l(21,"Vendor"),i(),n(22,"th",15),l(23,"Quantity"),i(),n(24,"th",16),l(25,"Latest Unit Price"),i(),n(26,"th",16),l(27,"Average Unit Price"),i(),n(28,"th",17),l(29,"Total"),i()()(),n(30,"tbody"),g(31,Xe,34,24,"ng-container",18),i()()()()),a&2){let f=N(9),d=N(11);m(6),c("nzSuffix",d)("nzSuffix",f),m(),D("ngModel",p.searchValue),m(5),D("nzVisible",p.isVisible),c("nzOkText","Submit")("nzOkDisabled",!p.inventoryItemForm.valid),m(2),c("nzShowPagination",!1)("nzPageSize",1e3)("nzData",p.listOfDisplayData)("nzFrontPagination",!1)("nzLoading",p.loading),m(4),c("nzSortFn",!0),m(13),c("ngForOf",p.listOfDisplayData)}},dependencies:[U,A,W,Z,Q,de,se,ue,_e,ge,fe,me,ce,pe,J,H,ze,Ie,xe,he,ve,ye,be,Se,Ee,Te,Ce,ne,X,Y,ee,ie,oe,te,j]});let e=o;return e})();var Ye=[{path:"",component:Ve,data:{name:" "}}],De=(()=>{let o=class o{};o.\u0275fac=function(a){return new(a||o)},o.\u0275mod=b({type:o}),o.\u0275inj=T({imports:[L.forChild(Ye),L]});let e=o;return e})();var Et=(()=>{let o=class o{};o.\u0275fac=function(a){return new(a||o)},o.\u0275mod=b({type:o}),o.\u0275inj=T({imports:[De,G,we,le,Me,ae]});let e=o;return e})();export{Et as InventoryManagementModule};
