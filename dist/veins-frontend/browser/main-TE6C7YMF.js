import{a as pe}from"./chunk-FRJ3UIHP.js";import{a as le}from"./chunk-SPHIXFP2.js";import"./chunk-NGE6N3H6.js";import{b as ce}from"./chunk-O3XA6K7N.js";import{b as ne,c as se}from"./chunk-EMPMCSMU.js";import{A as V,B as f,C as a,D as H,Da as _,Ea as m,G as Z,Ha as Q,Ia as O,Ja as X,Ka as ee,L as K,Ma as te,Na as re,Pa as ie,Qa as oe,Ta as R,W as $,X as q,Y as G,b as F,d as M,e as U,f as l,g as L,h as k,i as j,j as P,k as g,l as v,m as u,n as W,o as z,ob as ae,p as I,q as T,s as B,t as b,ua as C,va as J,wa as Y,y as p,yc as A,z as w}from"./chunk-ALXNCXXS.js";import"./chunk-NFQMHT45.js";import{a as x}from"./chunk-MON7YFGF.js";var ue=(()=>{let e=class e{constructor(t,r,n){this.http=t,this.platformId=r,this.appService=n}isLoggedIn(){if(m(this.platformId)){let t=localStorage.getItem("token");if(t){let r=this.getTokenExpirationDate(t);return r===void 0||r<=new Date?(this.logout(),!1):(this.setUserSubOrganization(),!0)}}return!1}getTokenExpirationDate(t){try{let r=JSON.parse(atob(t.split(".")[1]));return r&&r.exp?new Date(r.exp*1e3):void 0}catch{return}}logout(){localStorage.removeItem("token")}setUserSubOrganization(){this.appService.getAndSetUserDefaultSubOrganization()}};e.\u0275fac=function(r){return new(r||e)(a(O),a(f),a(se))},e.\u0275prov=p({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();var fe=(()=>{let e=class e{constructor(t,r){this.authService=t,this.router=r}canActivate(t,r){return this.authService.isLoggedIn()?!0:(this.router.navigate(["/login"]),!1)}};e.\u0275fac=function(r){return new(r||e)(a(ue),a(oe))},e.\u0275prov=p({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();var Ce=[{path:"",loadChildren:()=>import("./chunk-L3RLWPDR.js").then(i=>i.ShellModule),canActivate:[fe]},{path:"login",loadChildren:()=>import("./chunk-M27GAKNM.js").then(i=>i.LoginModule)}],me=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=b({type:e}),e.\u0275inj=w({imports:[R.forRoot(Ce),R]});let i=e;return i})();var he=(()=>{let e=class e{constructor(){this.title="Veins"}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=B({type:e,selectors:[["app-root"]],decls:3,vars:0,consts:[[1,"main"],[1,"content"]],template:function(r,n){r&1&&($(0,"main",0)(1,"div",1),G(2,"router-outlet"),q()())},dependencies:[ie],styles:[`[_nghost-%COMP%] {
    font-family: "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
      Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji",
      "Segoe UI Symbol";
    box-sizing: border-box;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  

  .content[_ngcontent-%COMP%] {
    display: flex;
    width: 100%;
    justify-content: center;
    margin-bottom: 3rem;
    margin: auto;
  }

  @media screen and (max-width: 650px) {
    .content[_ngcontent-%COMP%] {
      flex-direction: column;
      width: 100%;
    }
  }`]});let i=e;return i})();var N=(()=>{let e=class e{constructor(t,r){this.http=t,this.platformId=r}fetchIntegrationDetails(){return this.http.get("/api/organizations").toPromise().then(t=>{m(this.platformId)&&(localStorage.setItem("organizations",JSON.stringify(t)),t&&t.length&&t.some(r=>r.domain_name==location.hostname)&&(localStorage.setItem("organization",t.find(r=>r.domain_name==location.hostname)),localStorage.setItem("organization_id",t.find(r=>r.domain_name==location.hostname).id),console.log("organization found")))})}};e.\u0275fac=function(r){return new(r||e)(a(O),a(f))},e.\u0275prov=p({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();var S="Service workers are disabled or not supported by this browser";function Oe(i){return k(()=>U(new Error(i)))}var E=class{constructor(e){if(this.serviceWorker=e,!e)this.worker=this.events=this.registration=Oe(S);else{let t=j(e,"controllerchange").pipe(l(()=>e.controller)),r=k(()=>M(e.controller)),n=L(r,t);this.worker=n.pipe(v(d=>!!d)),this.registration=this.worker.pipe(I(()=>e.getRegistration()));let D=j(e,"message").pipe(l(d=>d.data)).pipe(v(d=>d&&d.type)).pipe(z());D.connect(),this.events=D}}postMessage(e,o){return this.worker.pipe(u(1),T(t=>{t.postMessage(x({action:e},o))})).toPromise().then(()=>{})}postMessageWithOperation(e,o,t){let r=this.waitForOperationCompleted(t),n=this.postMessage(e,o);return Promise.all([n,r]).then(([,c])=>c)}generateNonce(){return Math.round(Math.random()*1e7)}eventsOfType(e){let o;return typeof e=="string"?o=t=>t.type===e:o=t=>e.includes(t.type),this.events.pipe(v(o))}nextEventOfType(e){return this.eventsOfType(e).pipe(u(1))}waitForOperationCompleted(e){return this.eventsOfType("OPERATION_COMPLETED").pipe(v(o=>o.nonce===e),u(1),l(o=>{if(o.result!==void 0)return o.result;throw new Error(o.error)})).toPromise()}get isEnabled(){return!!this.serviceWorker}},be=(()=>{let e=class e{get isEnabled(){return this.sw.isEnabled}constructor(t){if(this.sw=t,this.pushManager=null,this.subscriptionChanges=new F,!t.isEnabled){this.messages=g,this.notificationClicks=g,this.subscription=g;return}this.messages=this.sw.eventsOfType("PUSH").pipe(l(n=>n.data)),this.notificationClicks=this.sw.eventsOfType("NOTIFICATION_CLICK").pipe(l(n=>n.data)),this.pushManager=this.sw.registration.pipe(l(n=>n.pushManager));let r=this.pushManager.pipe(I(n=>n.getSubscription()));this.subscription=P(r,this.subscriptionChanges)}requestSubscription(t){if(!this.sw.isEnabled||this.pushManager===null)return Promise.reject(new Error(S));let r={userVisibleOnly:!0},n=this.decodeBase64(t.serverPublicKey.replace(/_/g,"/").replace(/-/g,"+")),c=new Uint8Array(new ArrayBuffer(n.length));for(let s=0;s<n.length;s++)c[s]=n.charCodeAt(s);return r.applicationServerKey=c,this.pushManager.pipe(I(s=>s.subscribe(r)),u(1)).toPromise().then(s=>(this.subscriptionChanges.next(s),s))}unsubscribe(){if(!this.sw.isEnabled)return Promise.reject(new Error(S));let t=r=>{if(r===null)throw new Error("Not subscribed to push notifications.");return r.unsubscribe().then(n=>{if(!n)throw new Error("Unsubscribe failed!");this.subscriptionChanges.next(null)})};return this.subscription.pipe(u(1),I(t)).toPromise()}decodeBase64(t){return atob(t)}};e.\u0275fac=function(r){return new(r||e)(a(E))},e.\u0275prov=p({token:e,factory:e.\u0275fac});let i=e;return i})(),we=(()=>{let e=class e{get isEnabled(){return this.sw.isEnabled}constructor(t){if(this.sw=t,!t.isEnabled){this.versionUpdates=g,this.unrecoverable=g;return}this.versionUpdates=this.sw.eventsOfType(["VERSION_DETECTED","VERSION_INSTALLATION_FAILED","VERSION_READY","NO_NEW_VERSION_DETECTED"]),this.unrecoverable=this.sw.eventsOfType("UNRECOVERABLE_STATE")}checkForUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(S));let t=this.sw.generateNonce();return this.sw.postMessageWithOperation("CHECK_FOR_UPDATES",{nonce:t},t)}activateUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(S));let t=this.sw.generateNonce();return this.sw.postMessageWithOperation("ACTIVATE_UPDATE",{nonce:t},t)}};e.\u0275fac=function(r){return new(r||e)(a(E))},e.\u0275prov=p({token:e,factory:e.\u0275fac});let i=e;return i})();var de=new V("");function ke(i,e,o,t){return()=>{if(!(m(t)&&"serviceWorker"in navigator&&o.enabled!==!1))return;navigator.serviceWorker.addEventListener("controllerchange",()=>{navigator.serviceWorker.controller!==null&&navigator.serviceWorker.controller.postMessage({action:"INITIALIZE"})});let r;if(typeof o.registrationStrategy=="function")r=o.registrationStrategy();else{let[c,...s]=(o.registrationStrategy||"registerWhenStable:30000").split(":");switch(c){case"registerImmediately":r=M(null);break;case"registerWithDelay":r=ge(+s[0]||0);break;case"registerWhenStable":r=s[0]?P(ve(i),ge(+s[0])):ve(i);break;default:throw new Error(`Unknown ServiceWorker registration strategy: ${o.registrationStrategy}`)}}i.get(K).runOutsideAngular(()=>r.pipe(u(1)).subscribe(()=>navigator.serviceWorker.register(e,{scope:o.scope}).catch(c=>console.error("Service worker registration failed with:",c))))}}function ge(i){return M(null).pipe(W(i))}function ve(i){return i.get(J).isStable.pipe(v(o=>o))}function je(i,e){return new E(m(e)&&i.enabled!==!1?navigator.serviceWorker:void 0)}var y=class{};function Pe(i,e={}){return H([be,we,{provide:de,useValue:i},{provide:y,useValue:e},{provide:E,useFactory:je,deps:[y,f]},{provide:C,useFactory:ke,deps:[Z,de,y,f],multi:!0}])}var Ee=(()=>{let e=class e{static register(t,r={}){return{ngModule:e,providers:[Pe(t,r)]}}};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=b({type:e}),e.\u0275inj=w({providers:[be,we]});let i=e;return i})();var Ie=(()=>{let e=class e{constructor(t){this.userService=t}intercept(t,r){let n=localStorage.getItem("token")?.toString(),c=t.clone({setHeaders:{Authorization:`Bearer ${n}`}});return r.handle(c).pipe(T(s=>{s instanceof Q&&console.log("Successful Response:",s)},s=>{switch(s.status){case 401:this.userService.logout();break;case 500:break;case 600:break}console.error("Error Response:",s)}))}};e.\u0275fac=function(r){return new(r||e)(a(ne))},e.\u0275prov=p({token:e,factory:e.\u0275fac});let i=e;return i})();var Re=i=>()=>i.fetchIntegrationDetails(),ye=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=b({type:e,bootstrap:[he]}),e.\u0275inj=w({providers:[N,{provide:C,useFactory:Re,deps:[N],multi:!0},{provide:X,useClass:Ie,multi:!0}],imports:[_,re,ae,me,pe,le,ee,A,ce,Ee.register("ngsw-worker.js",{enabled:!Y(),registrationStrategy:"registerWhenStable:30000"}),A]});let i=e;return i})();te().bootstrapModule(ye).catch(i=>console.error(i));
